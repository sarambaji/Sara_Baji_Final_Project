suppressPackageStartupMessages({
library(tidyverse)
library(janitor)
})
# make sure ai confidence is 0–100
if (!is.na(ai_col)) {
dat <- dat %>%
mutate(!!ai_col := make_ai_0_100(.data[[ai_col]]))
}
# summary of variables
vars_we_want <- c(
guess_ai_col(names(dat)),
guess_recovery_col(names(dat)),
"patient_satisfaction",
"age"
)
vars_we_want <- vars_we_want[!is.na(vars_we_want)]
guess_ai_col(names(dat))
source("code/utils.R")               # should load the helper functions
source("code/01_load_and_clean.R")   # should load the data into 'dat'
ls()                                 # should include 'dat'
guess_ai_col(names(dat))
# makes a table for my final project
# table 1 = summary stats for main variables
suppressPackageStartupMessages({
library(tidyverse)
library(janitor)
})
source("code/utils.R")
source("code/01_load_and_clean.R")  # loads dat
# summary of variables
vars_we_want <- c(
guess_ai_col(names(dat)),
guess_recovery_col(names(dat)),
"patient_satisfaction",
"age"
)
vars_we_want <- vars_we_want[!is.na(vars_we_want)]
vars_we_want <- vars_we_want[vars_we_want %in% names(dat)]
if (length(vars_we_want) == 0) {
table1 <- tibble(
variable = character(),
n = integer(),
mean = numeric(),
sd = numeric(),
min = numeric(),
max = numeric()
)
} else {
table1 <- dat %>%
select(all_of(vars_we_want)) %>%
pivot_longer(everything(), names_to = "variable", values_to = "value") %>%
mutate(value = suppressWarnings(as.numeric(value))) %>%
group_by(variable) %>%
summarise(
n = sum(!is.na(value)),
mean = mean(value, na.rm = TRUE),
sd = sd(value, na.rm = TRUE),
min = min(value, na.rm = TRUE),
max = max(value, na.rm = TRUE),
.groups = "drop"
)
}
if (!dir.exists("tables")) dir.create("tables", recursive = TRUE)
readr::write_csv(table1, "tables/table1_summary.csv")
# Figure #1: AI confidence vs recovery time
suppressPackageStartupMessages({
library(tidyverse)
library(janitor)
})
source("code/utils.R")
source("code/01_load_and_clean.R")
ai_col <- guess_ai_col(names(dat))
recovery_col <- guess_recovery_col(names(dat))
if (!dir.exists("figs")) dir.create("figs", recursive = TRUE)
if (is.na(ai_col) || is.na(recovery_col)) {
p <- ggplot() +
annotate("text", x = 0.5, y = 0.5,
label = "ai_diagnosis_confidence or recovery_time not found",
size = 5) +
theme_void()
ggsave("figs/fig_ai_vs_recovery.png", p, width = 6, height = 4, dpi = 300)
} else {
df <- dat %>%
filter(!is.na(.data[[ai_col]]), !is.na(.data[[recovery_col]])) %>%
mutate(
ai_conf = as.numeric(.data[[ai_col]]),
rec_time = as.numeric(.data[[recovery_col]])
)
p <- ggplot(df, aes(x = ai_conf, y = rec_time)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE) +
labs(
title = "AI diagnosis confidence vs recovery time",
x = "AI diagnosis confidence",
y = "Recovery time (days)"
) +
theme_minimal()
ggsave("figs/fig_ai_vs_recovery.png", p, width = 6, height = 4, dpi = 300)
}
# helper functions for my project
# used to find the right columns and fix values
suppressPackageStartupMessages({
library(tidyverse)
library(janitor)
})
# try to guess column names for ai confidence and recovery time
guess_ai_col <- function(df_names) {
possible <- c("ai_diagnosis_confidence", "ai_confidence", "ai_score")
ai_col <- intersect(possible, df_names)
if (length(ai_col) > 0) ai_col[1] else NA
}
guess_recovery_col <- function(df_names) {
possible <- c("recovery_time", "recovery_days", "days_to_recovery")
col <- intersect(possible, df_names)
if (length(col) > 0) col[1] else NA
}
# if ai confidence is 0–1, change it to 0–100
make_ai_0_100 <- function(x) {
if (all(x >= 0, na.rm = TRUE) && all(x <= 1, na.rm = TRUE)) {
x * 100
} else {
x
}
}
setwd("..")   # move from report/ → project root
library(tidyverse)
library(janitor)
library(knitr)
source("../code/utils.R")
library(tidyverse)
library(janitor)
library(knitr)
source("../code/utils.R")
source("../code/01_load_and_clean.R")
# save a small preview of the cleaned data
if (!dir.exists("tables")) dir.create("tables", recursive = TRUE)
readr::write_csv(head(dat, 50), "tables/_data_preview.csv")
# helper functions for my project
# used to find the right columns and fix values
suppressPackageStartupMessages({
library(tidyverse)
library(janitor)
})
# try to guess column names for ai confidence and recovery time
guess_ai_col <- function(df_names) {
possible <- c("ai_diagnosis_confidence", "ai_confidence", "ai_score")
ai_col <- intersect(possible, df_names)
if (length(ai_col) > 0) ai_col[1] else NA
}
guess_recovery_col <- function(df_names) {
possible <- c("recovery_time", "recovery_days", "days_to_recovery")
col <- intersect(possible, df_names)
if (length(col) > 0) col[1] else NA
}
# if ai confidence is 0–1, change it to 0–100
make_ai_0_100 <- function(x) {
if (all(x >= 0, na.rm = TRUE) && all(x <= 1, na.rm = TRUE)) {
x * 100
} else {
x
}
}
# this file loads and cleans the AI in Healthcare dataset
suppressPackageStartupMessages({
library(tidyverse)
library(janitor)
})
source("code/utils.R")
# read the dataset
dat <- readr::read_csv("data/AI_in_HealthCare_Dataset.csv", show_col_types = FALSE)
# clean column names
dat <- dat %>% clean_names()
# find main columns
ai_col <- guess_ai_col(names(dat))
recovery_col <- guess_recovery_col(names(dat))
# make sure ai confidence is 0–100
if (!is.na(ai_col)) {
dat <- dat %>%
mutate(!!ai_col := make_ai_0_100(.data[[ai_col]]))
}
# save a small preview of the cleaned data
if (!dir.exists("tables")) dir.create("tables", recursive = TRUE)
readr::write_csv(head(dat, 50), "tables/_data_preview.csv")
library(tidyverse)
library(janitor)
library(knitr)
source("../code/utils.R")
source("../code/01_load_and_clean.R")
dim(dat)
head(dat)
# make sure the table exists
source("../code/02_make_table1.R")
getwd()
list.files(".")
# make sure the table exists
source("../code/02_make_table1.R")
getwd()
list.files(".")
library(tidyverse)
library(janitor)
library(knitr)
cat("WD is:\n"); print(getwd())
cat("\nchecking files from here:\n")
cat("../code/utils.R ->", file.exists("../code/utils.R"), "\n")
cat("../code/01_load_and_clean.R ->", file.exists("../code/01_load_and_clean.R"), "\n")
# only source if they exist
if (file.exists("../code/utils.R")) {
source("../code/utils.R")
} else {
stop("utils.R not found at ../code/utils.R")
}
if (file.exists("../code/01_load_and_clean.R")) {
source("../code/01_load_and_clean.R")
} else {
stop("01_load_and_clean.R not found at ../code/01_load_and_clean.R")
}
knitr::opts_knit$set(root.dir = "../")
getwd()
---
title: "final_report"
library(tidyverse)
library(janitor)
library(knitr)
source("code/utils.R")
library(tidyverse)
library(janitor)
library(knitr)
source("/ai_healthcare_project/code/utils.R")
knitr::opts_knit$set(root.dir = "..")
library(tidyverse)
library(janitor)
library(knitr)
source("code/utils.R")
knitr::opts_knit$set(root.dir = normalizePath(".."))
cat("Knit working directory is:", getwd(), "\n")
library(tidyverse)
library(janitor)
library(knitr)
source("code/utils.R")
knitr::opts_knit$set(root.dir = "..")
library(tidyverse)
library(janitor)
library(knitr)
source("../code/utils.R")
source("../code/01_load_and_clean.R")
setwd("..")
cat("WD is:", getwd(), "\n")
# 2. load packages
library(tidyverse)
library(janitor)
library(knitr)
# 3. NOW source from the root
source("code/utils.R")
source("code/01_load_and_clean.R")
knitr::opts_knit$set(root.dir = normalizePath(".."))
cat("Root directory is:", getwd(), "\n")
# load packages
library(tidyverse)
library(janitor)
library(knitr)
# source scripts using project-root paths
source("code/utils.R")
